function isValidUrl(e){try{var t=new URL(e);return"http:"===t.protocol||"https:"===t.protocol}catch{return!1}}function sortByDate(e){return e.slice().sort((e,t)=>new Date(e.date)-new Date(t.date))}function renderEvents(e,t,l,n){if(e&&0!==e.length){t.innerHTML="";let c=document.createDocumentFragment();e.forEach(n=>{var e=new Date(n.date),e=isNaN(e)?n.date:e.toLocaleDateString("en-US",{month:"long",day:"numeric"}),t=document.createElement("div"),a=(t.className="col-md-4",document.createElement("div")),r=(a.className="card event-card h-100",document.createElement("img"));r.loading="lazy",r.src=l+"/"+n.image,r.className="card-img-top",r.alt=n.title;let d=r;isValidUrl(n.link)&&((s=document.createElement("a")).href=n.link,s.addEventListener("click",e=>{var t=document.getElementById("eventLinkModal");"undefined"!=typeof bootstrap&&t&&(e.preventDefault(),(e=document.getElementById("eventLinkIframe"))&&(e.src="",e.setAttribute("data-src",n.link)),bootstrap.Modal.getOrCreateInstance(t).show())}),s.appendChild(r),d=s);var r=document.createElement("div"),s=(r.className="card-body",document.createElement("h5")),o=(s.className="card-title",s.textContent=n.title,document.createElement("p"));o.className="card-text",o.textContent=e,r.appendChild(s),r.appendChild(o),a.appendChild(d),a.appendChild(r),t.appendChild(a),c.appendChild(t)}),t.appendChild(c)}else t.innerHTML=`<p class="text-center w-100">${n}</p>`}async function loadEvents(){var e=document.getElementById("events"),t=document.getElementById("events-grid"),n=document.getElementById("events-archive"),a=document.getElementById("archive-grid");if(e&&t)try{var r=await fetch("assets/events/events_combined.json");if(!r.ok)throw new Error("Failed to fetch events");var d,s=await r.json();renderEvents(Array.isArray(s.upcoming)?sortByDate(s.upcoming):[],t,"assets/events","No upcoming events"),n&&a&&(0<(d=Array.isArray(s.archive)?sortByDate(s.archive):[]).length?renderEvents(d,a,"assets/events/archive","No past events"):n.style.display="none")}catch(e){console.warn("Could not load events:",e),renderEvents([],t,"assets/events","No upcoming events"),n&&(n.style.display="none")}}document.addEventListener("DOMContentLoaded",loadEvents);